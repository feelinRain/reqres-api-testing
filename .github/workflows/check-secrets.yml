name: Simple Secret Check
on: [push, pull_request]

jobs:
  check-secrets:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Check for exposed API keys
        run: |
          echo " Checking for exposed secrets..."
          
          # Fail if find real API keys
          if grep -r "REQRES_API_KEY=.*[A-Za-z0-9]{15,}" . --include="*.py" --include="*.json" --include="*.md"; then
            echo " ERROR: Found hardcoded API key!"
            exit 1
          fi
          
          # Fail if find .env files (except .env.example)
          if find . -name ".env" -type f | grep -v ".env.example"; then
            echo "ERROR: Found .env file with secrets!"
            exit 1
          fi
          
          # Fail if find Postman environment with real keys
          if find . -name "*.postman_environment.json" -type f -exec grep -l "your_real_key\|actual_key\|production_key" {} \;; then
            echo " ERROR: Postman environment contains real keys!"
            exit 1
          fi
          
          echo " PASS: No exposed secrets found"
